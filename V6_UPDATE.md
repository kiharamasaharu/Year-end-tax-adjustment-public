---
layout: default
title: "v6.0 アップデート情報"
permalink: /v6/
---

# v6.0 アップデート情報

## 🎯 新機能・改善点

### ✨ 主要な追加機能

- **複数ページのエクセルフォーマットに対応**
- **対応レイアウトの分岐ロジック修正**
- **バー表示の従業員名のスキップに対応**
- **給与データCSVファイルの処理に対応**
- **集計結果CSVダウンロードメニューに対応**
- **集計出力時に昇順設定での出力に対応**
- **集計出力時に列幅をフィットさせて出力に対応**

---

## 📄 複数ページのエクセルフォーマットに対応

### 概要

複数のシートを含むExcelファイルに対応しました。各シートを自動的に検出し、データを統合して処理します。

### 動作

- Excelファイル内のすべてのシートを自動検出
- 各シートからデータを読み込み
- 複数シートのデータを統合して集計処理
- シート名に関わらず、データが含まれているシートを自動的に処理

### メリット

- 月別にシートが分かれているExcelファイルにも対応
- 複数の部署やグループのデータが含まれるファイルにも対応
- 手動でのシート選択が不要

---

## 🔧 対応レイアウトの分岐ロジック修正

### 概要

レイアウト判定ロジックを改善し、より正確にレイアウトを識別できるようになりました。

### 改善内容

- レイアウト判定の精度向上
- エッジケースへの対応強化
- 判定エラーの削減

### 対応レイアウト

1. **縦型レイアウト**（v1から対応）
   - 1列目に項目名
   - 2列目以降に従業員データ

2. **横型レイアウト**（v4から対応）
   - 1列目に項目名
   - 2列目以降に従業員データ

3. **標準テーブル形式**（v5から対応）
   - 1行目に項目名
   - 2行目以降に従業員データ

---

## 👤 バー表示の従業員名のスキップに対応

### 概要

処理中の進捗表示（プログレスバー）において、従業員名の表示をスキップできるようになりました。

### 動作

- 処理中の従業員名表示をスキップ可能
- 処理速度の向上
- 大量データ処理時のパフォーマンス改善

### メリット

- 大量の従業員データを処理する際の表示負荷を軽減
- 処理速度の向上
- UIの応答性向上

---

## 📊 給与データCSVファイルの処理に対応

### 概要

給与データをCSV形式で処理できるようになりました。

### 対応形式

- **カンマ区切りCSV**（.csv）
- **タブ区切りTSV**（.tsv）
- **文字コード自動判定**
  - UTF-8
  - Shift-JIS
  - CP932

### 動作

- CSVファイルを自動検出
- 文字コードを自動判定
- 区切り文字を自動判定（カンマ/タブ）
- Excelファイルと同様に処理

### メリット

- CSV形式の給与データにも対応
- システムからエクスポートしたCSVファイルを直接処理可能
- 文字コードの手動指定が不要

---

## 💾 集計結果CSVダウンロードメニューに対応

### 概要

集計結果をCSV形式でダウンロードできるメニューを追加しました。

### 機能

- 「集計結果」シートをCSV形式でダウンロード
- 「月別集計」シートをCSV形式でダウンロード
- 「入退職者チェック」シートをCSV形式でダウンロード

### 使い方

1. メニューバー「給与明細集計」をクリック
2. 「📥 CSVダウンロード」メニューを選択
3. ダウンロードしたいシートを選択
4. CSVファイルがダウンロードされます

### メリット

- Excel以外のシステムへのデータ移行が容易
- データ分析ツールでの利用が簡単
- 標準的なCSV形式で出力

---

## 📈 集計出力時に昇順設定での出力に対応

### 概要

集計結果を従業員番号や氏名の昇順で出力できるようになりました。

### 動作

- 従業員番号の昇順でソート
- 氏名の五十音順でソート
- 支給月の昇順でソート

### 設定方法

- 集計実行時に自動的に昇順でソート
- 設定でソート順を変更可能（将来の機能拡張予定）

### メリット

- データの見やすさ向上
- 従業員の検索が容易
- データの整理が簡単

---

## 📏 集計出力時に列幅をフィットさせて出力に対応

### 概要

集計結果を出力する際に、列幅を自動的に調整して見やすく表示します。

### 動作

- 各列の内容に応じて列幅を自動調整
- ヘッダー行の幅も自動調整
- 数値データの表示幅を最適化

### メリット

- データの可読性向上
- 手動での列幅調整が不要
- 印刷時の見やすさ向上

---

## 🔄 v5.0からの主な変更点

| 項目 | v5.0 | v6.0 |
|------|------|------|
| 複数ページ対応 | ❌ | ✅ |
| レイアウト判定ロジック | 基本対応 | 改善・修正 ✨ |
| バー表示の最適化 | ❌ | ✅ |
| CSVファイル処理 | 基本対応 | 給与データCSV対応 ✨ |
| CSVダウンロード | ❌ | ✅ |
| 昇順ソート出力 | ❌ | ✅ |
| 列幅自動調整 | ❌ | ✅ |

---

## 📝 まとめ

### v6.0で追加・改善された機能

- ✅ 複数ページのエクセルフォーマットに対応
- ✅ 対応レイアウトの分岐ロジック修正
- ✅ バー表示の従業員名のスキップに対応
- ✅ 給与データCSVファイルの処理に対応
- ✅ 集計結果CSVダウンロードメニューに対応
- ✅ 集計出力時に昇順設定での出力に対応
- ✅ 集計出力時に列幅をフィットさせて出力に対応

### すべての対応形式

1. ✅ 縦型レイアウト
2. ✅ 横型レイアウト
3. ✅ 標準テーブル形式
4. ✅ 複数ページExcelファイル ← NEW!
5. ✅ CSVファイル（給与データ） ← NEW!

---

## 🚀 デプロイ

### Cloud Run functions

1. Google Cloud Console → Cloud Run
2. 関数を編集
3. `main.py`を v6.0に更新（複数ページ対応・CSV処理・出力改善を含む最新版）
4. デプロイ

**所要時間: 3-5分**

---

更新日: 2025年1月
バージョン: 6.0

